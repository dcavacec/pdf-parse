name: 4241M
version: "1.0"
description: Rules for 4241M standard PDF.

selection:
  filename_patterns: ["*4241M*.pdf"]
  method: auto
  pages: null  # all pages

extraction:
  # Keep tables that contain these headers (at least 2 of them)
  header_contains: ["Product", "Q1", "Q2", "Q3", "Q4", "Total"]
  min_match: 0.4
  min_shape:
    rows: 2
    cols: 2

transforms:
  - op: normalize_values
    strip: true
  - op: rename_columns
    mapping:
      "Q1 Sales": "Q1"
      "Q2 Sales": "Q2"
      "Q3 Sales": "Q3"
      "Q4 Sales": "Q4"
  - op: cast_columns
    types:
      Q1: number
      Q2: number
      Q3: number
      Q4: number
      Total: number

output:
  sheet_prefix: "4241M"

